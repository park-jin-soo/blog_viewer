<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì±„ìš°ë¯¸ ë¸”ë¡œê·¸ ë…¸ì¶œ/ëˆ„ë½ ë¶„ì„ê¸°</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg:#0d0f14; --surface:#161a24; --surface2:#1e2433;
      --border:#2a3045;
      --green:#00e676; --green-dim:#0d2e1c;
      --red:#ff5252;   --red-dim:#2e0d0d;
      --yellow:#ffd740; --blue:#40c4ff; --blue-dim:#0d1f2e;
      --text:#e8eaf6;  --text-dim:#78849e;
      --mono:'JetBrains Mono',monospace;
      --ko:'Noto Sans KR',sans-serif;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{background:var(--bg);color:var(--text);font-family:var(--ko);min-height:100vh;padding:32px 24px;}
    .wrap{max-width:1280px;margin:0 auto;}

    /* í—¤ë” */
    .hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px;padding-bottom:22px;border-bottom:1px solid var(--border);}
    .hd-left{display:flex;align-items:center;gap:14px;}
    .hd-icon{width:46px;height:46px;background:var(--green);border-radius:11px;display:flex;align-items:center;justify-content:center;font-size:22px;}
    .hd h1{font-size:20px;font-weight:900;letter-spacing:-.5px;}
    .hd p{color:var(--text-dim);font-size:12px;margin-top:4px;}
    .hd-btns{display:flex;align-items:center;gap:10px;}

    /* ê³µí†µ ë²„íŠ¼ */
    .icon-btn{display:flex;align-items:center;gap:8px;background:var(--surface2);border:1px solid var(--border);color:var(--text-dim);border-radius:9px;padding:10px 16px;font-size:13px;font-family:var(--ko);cursor:pointer;transition:all .2s;}
    .icon-btn:hover{border-color:var(--green);color:var(--green);}
    .icon-btn.blue:hover{border-color:var(--blue);color:var(--blue);}
    .api-status{display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:2px;}
    .api-ok{background:var(--green);box-shadow:0 0 6px var(--green);}
    .api-none{background:var(--red);}

    /* íƒ­ */
    .tabs{display:flex;gap:4px;margin-bottom:24px;border-bottom:1px solid var(--border);}
    .tab-btn{padding:10px 22px;font-size:13px;font-weight:700;font-family:var(--ko);background:none;border:none;color:var(--text-dim);cursor:pointer;border-bottom:2px solid transparent;margin-bottom:-1px;transition:all .2s;}
    .tab-btn:hover{color:var(--text);}
    .tab-btn.active{color:var(--green);border-bottom-color:var(--green);}
    .tab-content{display:none;}
    .tab-content.active{display:block;}

    /* ëª¨ë‹¬ ê³µí†µ */
    .modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:100;align-items:center;justify-content:center;}
    .modal-overlay.open{display:flex;}
    .modal{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:32px;width:520px;max-width:95vw;max-height:90vh;overflow-y:auto;}
    .modal h2{font-size:17px;font-weight:900;margin-bottom:8px;}
    .modal-close{float:right;background:none;border:none;color:var(--text-dim);font-size:20px;cursor:pointer;line-height:1;}
    .modal-close:hover{color:var(--text);}
    .modal-field{margin-bottom:16px;}
    .modal-field label{display:block;font-size:11px;color:var(--text-dim);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px;}
    .modal-input{width:100%;background:var(--surface2);border:1.5px solid var(--border);border-radius:8px;padding:11px 14px;color:var(--text);font-family:var(--mono);font-size:13px;outline:none;transition:border-color .2s;}
    .modal-input:focus{border-color:var(--green);}
    .modal-btns{display:flex;gap:10px;margin-top:24px;}
    .modal-save{flex:1;background:var(--green);color:#000;border:none;border-radius:8px;padding:12px;font-weight:700;font-size:14px;font-family:var(--ko);cursor:pointer;}
    .modal-save:hover{opacity:.85;}
    .modal-cancel{background:var(--surface2);color:var(--text-dim);border:1px solid var(--border);border-radius:8px;padding:12px 20px;font-size:14px;font-family:var(--ko);cursor:pointer;}
    .save-msg{display:none;color:var(--green);font-size:12px;margin-top:10px;text-align:center;}

    /* ë°œê¸‰ ì•ˆë‚´ ëª¨ë‹¬ ì „ìš© */
    .guide-step{display:flex;gap:14px;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid var(--border);}
    .guide-step:last-of-type{border-bottom:none;margin-bottom:0;padding-bottom:0;}
    .guide-num{width:28px;height:28px;border-radius:50%;background:var(--green);color:#000;font-size:13px;font-weight:900;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:2px;}
    .guide-body h4{font-size:14px;font-weight:700;margin-bottom:4px;}
    .guide-body p{color:#8ec8f0;font-size:12px;line-height:1.7;}
    .guide-body p strong{color:var(--blue);}
    .guide-link{display:inline-flex;align-items:center;gap:6px;margin-top:8px;background:var(--blue-dim);border:1px solid #1a4a6e;color:var(--blue);border-radius:7px;padding:7px 14px;font-size:12px;font-weight:700;text-decoration:none;transition:all .2s;}
    .guide-link:hover{background:#102a40;border-color:var(--blue);}
    .guide-tip{background:var(--surface2);border:1px solid var(--border);border-radius:8px;padding:12px 14px;margin-top:14px;font-size:11px;color:var(--text-dim);line-height:1.7;}
    .guide-tip strong{color:var(--yellow);}

    /* í¼ */
    .inp{background:var(--surface);border:1.5px solid var(--border);border-radius:10px;padding:13px 18px;color:var(--text);font-size:15px;font-family:var(--ko);outline:none;transition:border-color .2s;width:100%;}
    .inp:focus{border-color:var(--green);}
    .inp::placeholder{color:var(--text-dim);}
    .btn{background:var(--green);color:#000;border:none;border-radius:10px;padding:13px 28px;font-weight:700;font-size:15px;font-family:var(--ko);cursor:pointer;}
    .btn:hover{opacity:.85;}
    .btn:disabled{opacity:.4;cursor:not-allowed;}

    /* ì•ˆë‚´ ë°°ë„ˆ */
    .notice-banner{display:flex;align-items:flex-start;gap:12px;background:var(--blue-dim);border:1px solid #1a4a6e;border-left:4px solid var(--blue);border-radius:10px;padding:14px 18px;margin-bottom:20px;line-height:1.7;}
    .nb-icon{font-size:18px;flex-shrink:0;margin-top:1px;}
    .nb-title{color:var(--blue);font-weight:700;font-size:13px;margin-bottom:2px;}
    .nb-body{color:#8ec8f0;font-size:12px;}
    .nb-body strong{color:var(--blue);}

    /* í†µê³„ */
    .stats{display:flex;gap:14px;margin-bottom:22px;}
    .sc{flex:1;background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:14px 18px;}
    .sc-label{font-size:10px;color:var(--text-dim);text-transform:uppercase;letter-spacing:.8px;}
    .sc-val{font-size:28px;font-weight:900;margin-top:4px;font-family:var(--mono);}
    .c-blue{color:var(--blue);}.c-green{color:var(--green);}.c-red{color:var(--red);}.c-yellow{color:var(--yellow);}

    /* ê·¸ë¦¬ë“œ/íŒ¨ë„ */
    .grid{display:grid;grid-template-columns:360px 1fr;gap:18px;}
    @media(max-width:900px){.grid{grid-template-columns:1fr;}}
    .panel{background:var(--surface);border:1px solid var(--border);border-radius:13px;overflow:hidden;}
    .ph{padding:12px 18px;border-bottom:1px solid var(--border);font-size:11px;font-weight:700;letter-spacing:1px;color:var(--text-dim);text-transform:uppercase;display:flex;align-items:center;gap:8px;}
    .dot{width:8px;height:8px;border-radius:50%;}
    .dg{background:var(--green);}.db{background:var(--blue);}

    /* ì½˜ì†” */
    .console{background:#06080d;font-family:var(--mono);font-size:11.5px;line-height:1.8;height:520px;overflow-y:auto;padding:14px 18px;}
    .console::-webkit-scrollbar{width:3px;}
    .console::-webkit-scrollbar-thumb{background:var(--border);}
    .ll{color:var(--green);}.ll.err{color:var(--red);}.ll.sep{color:#283040;}
    .lempty{color:#283040;font-style:italic;}

    /* í…Œì´ë¸” */
    .rs{height:520px;overflow-y:auto;}
    .rs::-webkit-scrollbar{width:3px;}
    .rs::-webkit-scrollbar-thumb{background:var(--border);}
    table{width:100%;border-collapse:collapse;}
    thead th{padding:11px 14px;text-align:left;font-size:10px;font-weight:700;letter-spacing:.8px;color:var(--text-dim);text-transform:uppercase;background:var(--surface2);position:sticky;top:0;z-index:1;}
    tbody tr{border-bottom:1px solid var(--border);transition:background .15s;}
    tbody tr:hover{background:var(--surface2);}
    td{padding:11px 14px;font-size:13px;vertical-align:middle;}
    .tn{color:var(--text-dim);font-family:var(--mono);font-size:10px;width:36px;}
    .td-date{color:var(--text-dim);font-family:var(--mono);font-size:11px;white-space:nowrap;}
    .tt a{color:var(--text);text-decoration:none;font-weight:500;display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:360px;}
    .tt a:hover{color:var(--green);}
    .badge{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:5px;font-size:11px;font-weight:700;}
    .bok{background:var(--green-dim);color:var(--green);}
    .bmiss{background:var(--red-dim);color:var(--red);}
    .empty{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;color:var(--text-dim);font-size:13px;gap:8px;}

    /* í‚¤ì›Œë“œ íƒ­ */
    .kw-form{display:flex;flex-direction:column;gap:12px;margin-bottom:20px;}
    .kw-textarea{width:100%;background:var(--surface);border:1.5px solid var(--border);border-radius:10px;padding:13px 18px;color:var(--text);font-size:14px;font-family:var(--ko);outline:none;transition:border-color .2s;resize:vertical;min-height:110px;line-height:1.9;}
    .kw-textarea:focus{border-color:var(--green);}
    .kw-textarea::placeholder{color:var(--text-dim);}
    .kw-hint{color:var(--text-dim);font-size:11px;margin-top:-4px;}

    /* í‚¤ì›Œë“œ ê²°ê³¼ ì¹´ë“œ */
    .kw-results{display:flex;flex-direction:column;gap:16px;}
    .kw-card{background:var(--surface);border:1px solid var(--border);border-radius:13px;overflow:hidden;}
    .kw-card-header{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;background:var(--surface2);border-bottom:1px solid var(--border);}
    .kw-card-title{font-size:15px;font-weight:700;}
    .kw-card-sub{font-size:11px;color:var(--text-dim);margin-top:3px;}
    .kw-rank{font-size:24px;font-weight:900;font-family:var(--mono);}
    .kw-rank.found{color:var(--green);}
    .kw-rank.not-found{color:var(--red);font-size:13px;font-weight:700;}
    .kw-card-body{padding:16px 20px;}
    .kw-my-result{padding:10px 14px;border-radius:8px;margin-bottom:14px;border-left:3px solid;}
    .kw-my-result.found{background:var(--green-dim);border-color:var(--green);}
    .kw-my-result.not-found{background:var(--red-dim);border-color:var(--red);}
    .kw-my-label{font-size:11px;font-weight:700;margin-bottom:4px;}
    .kw-my-label.found{color:var(--green);}
    .kw-my-label.not-found{color:var(--red);}
    .kw-my-post-title a{color:var(--text);text-decoration:none;font-size:13px;}
    .kw-my-post-title a:hover{color:var(--green);}
    .kw-top-label{font-size:10px;color:var(--text-dim);text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px;}
    .kw-item{display:flex;align-items:center;gap:10px;padding:9px 0;border-bottom:1px solid var(--border);}
    .kw-item:last-child{border-bottom:none;}
    .kw-item-num{color:var(--text-dim);font-family:var(--mono);font-size:11px;width:30px;flex-shrink:0;}
    .kw-item-info{flex:1;min-width:0;}
    .kw-item-info a{color:var(--text);text-decoration:none;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;max-width:600px;}
    .kw-item-info a:hover{color:var(--blue);}
    .kw-item-blogger{color:var(--text-dim);font-size:11px;margin-top:2px;}
    .kw-mine-tag{background:var(--green-dim);color:var(--green);font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px;flex-shrink:0;}

    /* ë¡œë”© */
    #loading-overlay{display:none;position:fixed;inset:0;background:rgba(13,15,20,.88);z-index:200;flex-direction:column;align-items:center;justify-content:center;gap:22px;}
    #loading-overlay.show{display:flex;}
    .ld-dots{display:flex;gap:10px;}
    .ld-dots span{width:12px;height:12px;border-radius:50%;background:var(--green);animation:ld-bounce 1.2s infinite ease-in-out;}
    .ld-dots span:nth-child(1){animation-delay:0s}.ld-dots span:nth-child(2){animation-delay:.2s}.ld-dots span:nth-child(3){animation-delay:.4s}.ld-dots span:nth-child(4){animation-delay:.6s}.ld-dots span:nth-child(5){animation-delay:.8s}
    @keyframes ld-bounce{0%,80%,100%{transform:scale(.5);opacity:.3}40%{transform:scale(1.2);opacity:1}}
    .ld-text{color:var(--text);font-size:15px;font-weight:700;}
    .ld-sub{color:var(--text-dim);font-size:12px;margin-top:-10px;}
  </style>
</head>
<body>
<div class="wrap">

  <!-- í—¤ë” -->
  <div class="hd">
    <div class="hd-left">
      <div class="hd-icon">ğŸ”</div>
      <div>
        <h1>ì±„ìš°ë¯¸ ë¸”ë¡œê·¸ ë…¸ì¶œ/ëˆ„ë½ ë¶„ì„ê¸°</h1>
        <p>ë¸”ë¡œê·¸ë·° ë…¸ì¶œ ì—¬ë¶€ì™€ í‚¤ì›Œë“œ ìˆœìœ„ë¥¼ ë¹ ë¥´ê²Œ í™•ì¸í•©ë‹ˆë‹¤</p>
      </div>
    </div>
    <div class="hd-btns">
      <button class="icon-btn blue" onclick="openGuideModal()">
        ğŸ“‹ API ë°œê¸‰ ì•ˆë‚´
      </button>
      <button class="icon-btn" onclick="openApiModal()">
        <span class="api-status" id="apiDot"></span>âš™ï¸ API ì„¤ì •
        <span id="apiStatusLabel" style="font-size:11px"></span>
      </button>
    </div>
  </div>


  <!-- ì†Œí†µë°© ë°°ë„ˆ -->
  <a href="https://open.kakao.com/o/g0BjbBQh" target="_blank" style="display:block;text-decoration:none;margin-bottom:20px;">
    <div style="
      background: linear-gradient(135deg, #1a1a2e 0%, #0d2e1c 100%);
      border: 1px solid var(--green);
      border-radius: 12px;
      padding: 14px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
      transition: all .2s;
      cursor: pointer;
    " onmouseover="this.style.borderColor='#00ff88';this.style.boxShadow='0 0 16px rgba(0,230,118,.2)'" onmouseout="this.style.borderColor='var(--green)';this.style.boxShadow='none'">
      <div style="display:flex;align-items:center;gap:12px;">
        <span style="font-size:26px;">ğŸ’¬</span>
        <div>
          <div style="font-size:14px;font-weight:900;color:var(--green);letter-spacing:-.3px;">ë” ë§ì€ ìë™í™” í”„ë¡œê·¸ë¨ê³¼ ë¸”ë¡œê·¸ í’ˆì•—ì´ë¥¼ í•˜ë©° ì†Œí†µí•˜ì‹¤ ë¶„ë“¤ì€</div>
          <div style="font-size:12px;color:#8ec8f0;margin-top:3px;">ì†Œí†µë°©ì—ì„œ ê°™ì´ ë¸”ë¡œê·¸ ìƒí™œ ì¦ê²¨ìš”!! ğŸ™Œ</div>
        </div>
      </div>
      <div style="
        background:#FEE500;color:#000;
        border-radius:12px;padding:8px 16px;
        font-size:13px;font-weight:900;
        white-space:nowrap;flex-shrink:0;
        display:flex;align-items:center;gap:7px;
      ">
        <svg width="20" height="20" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <ellipse cx="20" cy="17" rx="17" ry="14" fill="#3A1D1D"/>
          <ellipse cx="20" cy="17" rx="14" ry="11.5" fill="#3A1D1D"/>
          <path d="M20 7C11.716 7 5 12.149 5 18.5c0 4.08 2.69 7.663 6.75 9.74L10 33l5.53-3.31C16.97 29.88 18.46 30 20 30c8.284 0 15-5.149 15-11.5S28.284 7 20 7z" fill="#FEE500"/>
          <circle cx="13.5" cy="18.5" r="2" fill="#3A1D1D"/>
          <circle cx="20" cy="18.5" r="2" fill="#3A1D1D"/>
          <circle cx="26.5" cy="18.5" r="2" fill="#3A1D1D"/>
        </svg>
        ì†Œí†µë°© ì…ì¥
      </div>
    </div>
  </a>

  <!-- íƒ­ -->
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('tab-analyze',this)">ğŸ“Š ë¸”ë¡œê·¸ ë…¸ì¶œ ë¶„ì„</button>
    <button class="tab-btn" onclick="switchTab('tab-keyword',this)">ğŸ”‘ í‚¤ì›Œë“œ ìˆœìœ„ í™•ì¸</button>
  </div>

  <!-- â•â• íƒ­1: ë…¸ì¶œ ë¶„ì„ â•â• -->
  <div id="tab-analyze" class="tab-content active">
    <div style="display:flex;gap:10px;margin-bottom:16px;">
      <input id="blogIdInput" class="inp" placeholder="ë„¤ì´ë²„ ë¸”ë¡œê·¸ ì•„ì´ë”” ì…ë ¥ (ì˜ˆ: brain_1018)" style="flex:1">
      <button class="btn" id="analyzeBtn" onclick="startAnalysis()">ë¶„ì„ ì‹œì‘</button>
    </div>

    <div class="notice-banner">
      <div class="nb-icon">â„¹ï¸</div>
      <div>
        <div class="nb-title">ë…¸ì¶œ / ëˆ„ë½ íŒë‹¨ ê¸°ì¤€ ì•ˆë‚´</div>
        <div class="nb-body">í¬ìŠ¤íŒ… ì œëª©ìœ¼ë¡œ ë„¤ì´ë²„ ë¸”ë¡œê·¸ ê²€ìƒ‰ ì‹œ <strong>ìƒìœ„ 100ìœ„ ì´ë‚´</strong>ì— ì¡´ì¬í•˜ë©´ <strong>âœ“ ë…¸ì¶œ</strong>, ì—†ìœ¼ë©´ <strong>âœ— ëˆ„ë½</strong>ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ì‹¤ì œ ë¸”ë¡œê·¸ë·° ê²°ê³¼ì™€ ë‹¤ì†Œ ì°¨ì´ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
      </div>
    </div>

    <div class="stats" id="statsArea" style="display:none">
      <div class="sc"><div class="sc-label">ì „ì²´ í¬ìŠ¤íŒ…</div><div class="sc-val c-blue" id="statTotal">0</div></div>
      <div class="sc"><div class="sc-label">ë¸”ë¡œê·¸ë·° ë…¸ì¶œ</div><div class="sc-val c-green" id="statExposed">0</div></div>
      <div class="sc"><div class="sc-label">ëˆ„ë½</div><div class="sc-val c-red" id="statMissed">0</div></div>
      <div class="sc"><div class="sc-label">ë…¸ì¶œë¥ </div><div class="sc-val c-yellow" id="statRate">0%</div></div>
    </div>

    <div class="grid">
      <div class="panel">
        <div class="ph"><span class="dot dg"></span>ì²˜ë¦¬ ë¡œê·¸</div>
        <div class="console" id="console"><div class="lempty">ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ê³  ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”.</div></div>
      </div>
      <div class="panel">
        <div class="ph"><span class="dot db"></span>ë¶„ì„ ê²°ê³¼ (<span id="resultCount">0</span>ê°œ)</div>
        <div class="rs" id="resultArea">
          <div class="empty"><span style="font-size:32px">ğŸ“­</span><span id="emptyMsg">ë¨¼ì € âš™ï¸ API ì„¤ì •ì„ ì™„ë£Œí•˜ì„¸ìš”</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â• íƒ­2: í‚¤ì›Œë“œ ìˆœìœ„ â•â• -->
  <div id="tab-keyword" class="tab-content">
    <div class="kw-form">
      <input id="kwBlogIdInput" class="inp" placeholder="ë‚´ ë„¤ì´ë²„ ë¸”ë¡œê·¸ ì•„ì´ë”” (ì˜ˆ: brain_1018)">
      <div>
        <textarea id="kwInput" class="kw-textarea" placeholder="í™•ì¸í•  í‚¤ì›Œë“œë¥¼ í•œ ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ì„¸ìš”&#10;ì˜ˆ)&#10;ê°•ë‚¨ ë§›ì§‘&#10;ì œì£¼ë„ ì—¬í–‰ ì½”ìŠ¤&#10;ë‹¤ì´ì–´íŠ¸ ì‹ë‹¨"></textarea>
        <div class="kw-hint">ğŸ’¡ ì—¬ëŸ¬ ê°œ ì…ë ¥ ì‹œ í•œ ë²ˆì— ëª¨ë‘ í™•ì¸í•©ë‹ˆë‹¤ (ìµœëŒ€ 20ê°œ)</div>
      </div>
      <button class="btn" id="kwBtn" onclick="startKeywordCheck()">ìˆœìœ„ í™•ì¸ ì‹œì‘</button>
    </div>

    <div class="notice-banner">
      <div class="nb-icon">ğŸ”‘</div>
      <div>
        <div class="nb-title">í‚¤ì›Œë“œ ìˆœìœ„ í™•ì¸ ì•ˆë‚´</div>
        <div class="nb-body">ì…ë ¥í•œ í‚¤ì›Œë“œë¡œ ë„¤ì´ë²„ ë¸”ë¡œê·¸ë¥¼ ê²€ìƒ‰í•˜ì—¬ <strong>ë‚´ ë¸”ë¡œê·¸ ê¸€ì´ ëª‡ ìœ„</strong>ì— ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. <strong>ìƒìœ„ 100ìœ„</strong>ê¹Œì§€ íƒìƒ‰í•˜ë©°, ìƒìœ„ 5ê°œ ê²€ìƒ‰ ê²°ê³¼ë„ í•¨ê»˜ í‘œì‹œë©ë‹ˆë‹¤.</div>
      </div>
    </div>

    <div id="kwResults" class="kw-results"></div>
  </div>

</div><!-- /wrap -->

<!-- ë¡œë”© -->
<div id="loading-overlay">
  <div class="ld-dots"><span></span><span></span><span></span><span></span><span></span></div>
  <div class="ld-text" id="ldText">ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</div>
  <div class="ld-sub" id="ldSub">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</div>
</div>

<!-- â•â• API ë°œê¸‰ ì•ˆë‚´ ëª¨ë‹¬ â•â• -->
<div class="modal-overlay" id="guideModal">
  <div class="modal">
    <button class="modal-close" onclick="closeGuideModal()">âœ•</button>
    <h2 style="margin-bottom:18px;">ğŸ“‹ ë„¤ì´ë²„ API ë°œê¸‰ ì•ˆë‚´</h2>

    <div class="guide-step">
      <div class="guide-num">1</div>
      <div class="guide-body">
        <h4>ë„¤ì´ë²„ ê°œë°œì ì„¼í„° ì ‘ì†</h4>
        <p>ì•„ë˜ ë§í¬ë¡œ ë„¤ì´ë²„ ê°œë°œì ì„¼í„°ì— ì ‘ì†í•©ë‹ˆë‹¤.<br>ë„¤ì´ë²„ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
        <a class="guide-link" href="https://developers.naver.com/main/" target="_blank">ğŸ”— developers.naver.com ë°”ë¡œê°€ê¸°</a>
      </div>
    </div>

    <div class="guide-step">
      <div class="guide-num">2</div>
      <div class="guide-body">
        <h4>ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡</h4>
        <p>ìƒë‹¨ ë©”ë‰´ <strong>Application â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡</strong> í´ë¦­<br>
        ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¦„ì€ ì•„ë¬´ê±°ë‚˜ ì…ë ¥í•´ë„ ë©ë‹ˆë‹¤. (ì˜ˆ: ë¸”ë¡œê·¸ë¶„ì„ê¸°)</p>
      </div>
    </div>

    <div class="guide-step">
      <div class="guide-num">3</div>
      <div class="guide-body">
        <h4>ì‚¬ìš© API ì„ íƒ</h4>
        <p>ì‚¬ìš© API ëª©ë¡ì—ì„œ <strong>ê²€ìƒ‰</strong> ì„ ì„ íƒí•©ë‹ˆë‹¤.<br>
        í™˜ê²½ì€ <strong>WEB</strong> ì„ íƒ í›„ ì„œë¹„ìŠ¤ URLì—<br>
        <strong>https://ë³¸ì¸ì•„ì´ë””.github.io</strong> ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.</p>
        <a class="guide-link" href="https://developers.naver.com/apps/#/register" target="_blank">ğŸ”— ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±ë¡ ë°”ë¡œê°€ê¸°</a>
      </div>
    </div>

    <div class="guide-step">
      <div class="guide-num">4</div>
      <div class="guide-body">
        <h4>Client ID / Client Secret í™•ì¸</h4>
        <p>ë“±ë¡ ì™„ë£Œ í›„ <strong>ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜</strong> í˜ì´ì§€ì—ì„œ<br>
        <strong>Client ID</strong> ì™€ <strong>Client Secret</strong> ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
        ë³µì‚¬ í›„ ì´ ì‚¬ì´íŠ¸ì˜ <strong>âš™ï¸ API ì„¤ì •</strong>ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.</p>
        <a class="guide-link" href="https://developers.naver.com/apps/#/list" target="_blank">ğŸ”— ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜ ëª©ë¡ ë°”ë¡œê°€ê¸°</a>
      </div>
    </div>

    <div class="guide-tip">
      ğŸ’¡ <strong>ì°¸ê³ ì‚¬í•­</strong><br>
      â€¢ API í˜¸ì¶œì€ <strong>í•˜ë£¨ 25,000ê±´</strong> ë¬´ë£Œë¡œ ì œê³µë©ë‹ˆë‹¤.<br>
      â€¢ API í‚¤ëŠ” ë³¸ì¸ ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë˜ë©° ì™¸ë¶€ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
      â€¢ ë“±ë¡ í›„ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. (ì‹¬ì‚¬ ë¶ˆí•„ìš”)
    </div>

    <div style="margin-top:20px;text-align:center;">
      <button class="btn" onclick="closeGuideModal();openApiModal();" style="width:100%;">âœ… ë°œê¸‰ ì™„ë£Œ â†’ API í‚¤ ì…ë ¥í•˜ëŸ¬ ê°€ê¸°</button>
    </div>
  </div>
</div>

<!-- â•â• API ì„¤ì • ëª¨ë‹¬ â•â• -->
<div class="modal-overlay" id="apiModal">
  <div class="modal">
    <button class="modal-close" onclick="closeApiModal()">âœ•</button>
    <h2>âš™ï¸ ë„¤ì´ë²„ API ì„¤ì •</h2>
    <p style="color:var(--text-dim);font-size:12px;margin:8px 0 24px;line-height:1.6;">
      ë°œê¸‰ë°›ì€ API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”. í•œ ë²ˆ ì €ì¥í•˜ë©´ ë¸Œë¼ìš°ì €ë¥¼ ë‹«ì•„ë„ ìœ ì§€ë©ë‹ˆë‹¤.<br>
      <span style="color:var(--text-dim);font-size:11px;">â€» API í‚¤ê°€ ì—†ìœ¼ì‹ ê°€ìš”?</span>
      <button onclick="closeApiModal();openGuideModal();" style="background:none;border:none;color:var(--blue);font-size:11px;cursor:pointer;text-decoration:underline;">ë°œê¸‰ ì•ˆë‚´ ë³´ê¸° â†’</button>
    </p>
    <div class="modal-field">
      <label>Client ID</label>
      <input type="text" id="clientId" class="modal-input" placeholder="Client ID ì…ë ¥">
    </div>
    <div class="modal-field">
      <label>Client Secret</label>
      <input type="password" id="clientSecret" class="modal-input" placeholder="Client Secret ì…ë ¥">
    </div>
    <div class="modal-btns">
      <button class="modal-save" onclick="saveConfig()">ğŸ’¾ ì €ì¥</button>
      <button class="modal-cancel" onclick="closeApiModal()">ì·¨ì†Œ</button>
    </div>
    <div class="save-msg" id="saveMsg">âœ… ì €ì¥ ì™„ë£Œ! API í‚¤ê°€ ë¸Œë¼ìš°ì €ì— ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
  </div>
</div>

<script>
  const PROXY = 'https://billowing-fog-1eed.woodpano.workers.dev';

  // íƒ­
  function switchTab(id, btn) {
    document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    btn.classList.add('active');
  }

  // API í‚¤
  function getConfig() {
    return { clientId: localStorage.getItem('naver_client_id')||'', clientSecret: localStorage.getItem('naver_client_secret')||'' };
  }
  function updateApiStatus() {
    const {clientId, clientSecret} = getConfig();
    const ok = !!(clientId && clientSecret);
    document.getElementById('apiDot').className = 'api-status ' + (ok ? 'api-ok' : 'api-none');
    const lbl = document.getElementById('apiStatusLabel');
    lbl.textContent = ok ? 'ì €ì¥ë¨' : 'ë¯¸ì„¤ì •';
    lbl.style.color = ok ? 'var(--green)' : 'var(--red)';
    document.getElementById('emptyMsg').textContent = ok ? 'ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤' : 'ë¨¼ì € âš™ï¸ API ì„¤ì •ì„ ì™„ë£Œí•˜ì„¸ìš”';
    if (clientId) document.getElementById('clientId').value = clientId;
    if (clientSecret) document.getElementById('clientSecret').value = clientSecret;
  }
  updateApiStatus();

  // ë°œê¸‰ ì•ˆë‚´ ëª¨ë‹¬
  function openGuideModal()  { document.getElementById('guideModal').classList.add('open'); }
  function closeGuideModal() { document.getElementById('guideModal').classList.remove('open'); }
  document.getElementById('guideModal').addEventListener('click', e => { if (e.target===e.currentTarget) closeGuideModal(); });

  // API ì„¤ì • ëª¨ë‹¬
  function openApiModal()  { document.getElementById('apiModal').classList.add('open'); }
  function closeApiModal() { document.getElementById('apiModal').classList.remove('open'); }
  document.getElementById('apiModal').addEventListener('click', e => { if (e.target===e.currentTarget) closeApiModal(); });

  function saveConfig() {
    const id = document.getElementById('clientId').value.trim();
    const secret = document.getElementById('clientSecret').value.trim();
    if (!id||!secret) { alert('Client IDì™€ Client Secretì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
    localStorage.setItem('naver_client_id', id);
    localStorage.setItem('naver_client_secret', secret);
    document.getElementById('saveMsg').style.display = 'block';
    setTimeout(() => { closeApiModal(); document.getElementById('saveMsg').style.display='none'; updateApiStatus(); }, 1200);
  }

  // ë¡œë”©
  function showLoading(text, sub) {
    document.getElementById('ldText').textContent = text || 'ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...';
    document.getElementById('ldSub').textContent  = sub  || 'ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”';
    document.getElementById('loading-overlay').classList.add('show');
  }
  function hideLoading() { document.getElementById('loading-overlay').classList.remove('show'); }

  // ë¡œê·¸
  let logCount = 0;
  function writeLog(msg, type='') {
    logCount++;
    const con = document.getElementById('console');
    const div = document.createElement('div');
    div.className = 'll' + (type ? ' '+type : '');
    div.textContent = '>>> ' + msg;
    if (logCount === 1) con.innerHTML = '';
    con.appendChild(div);
    con.scrollTop = con.scrollHeight;
  }
  function clearLog() { logCount=0; document.getElementById('console').innerHTML=''; }

  // ê³µí†µ ê²€ìƒ‰
  async function searchBlog(query, clientId, clientSecret) {
    const res = await fetch(`${PROXY}/search?query=${encodeURIComponent(query)}`, {
      headers: {'X-Client-Id': clientId, 'X-Client-Secret': clientSecret}
    });
    if (!res.ok) return [];
    return (await res.json()).items || [];
  }

  // RSS
  async function fetchRSS(blogId) {
    const res = await fetch(`${PROXY}/rss?blog_id=${blogId}`);
    const xml = new DOMParser().parseFromString(await res.text(), 'application/xml');
    const posts = [];
    xml.querySelectorAll('item').forEach(item => {
      const title   = item.querySelector('title')?.textContent?.trim() || '';
      const link    = item.querySelector('link')?.textContent?.trim() || '';
      const pubDate = item.querySelector('pubDate')?.textContent?.trim() || '';
      let logNo = '';
      if (link.includes('logNo=')) logNo = link.split('logNo=')[1].split('&')[0];
      else { const p = link.replace(/\/$/,'').split('/'); logNo = p[p.length-1].split('?')[0]; }
      let dateStr = '';
      try { const d = new Date(pubDate); if (!isNaN(d)) dateStr = `${d.getFullYear()}.${String(d.getMonth()+1).padStart(2,'0')}.${String(d.getDate()).padStart(2,'0')}`; } catch {}
      if (title && link) posts.push({title, url:link, logNo, pubDate:dateStr});
    });
    return posts;
  }

  // â•â• íƒ­1: ë…¸ì¶œ ë¶„ì„ â•â•
  async function startAnalysis() {
    const blogId = document.getElementById('blogIdInput').value.trim();
    if (!blogId) { alert('ë¸”ë¡œê·¸ ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
    const {clientId, clientSecret} = getConfig();
    if (!clientId||!clientSecret) { alert('ë¨¼ì € âš™ï¸ API ì„¤ì •ì„ ì™„ë£Œí•˜ì„¸ìš”.'); openApiModal(); return; }

    showLoading('ë¸”ë¡œê·¸ í¬ìŠ¤íŒ… ë¶„ì„ ì¤‘...', 'í¬ìŠ¤íŒ… ìˆ˜ì— ë”°ë¼ ë‹¤ì†Œ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤');
    document.getElementById('analyzeBtn').disabled = true;
    document.getElementById('statsArea').style.display = 'none';
    document.getElementById('resultArea').innerHTML = '';
    document.getElementById('resultCount').textContent = '0';
    clearLog();

    try {
      writeLog('='.repeat(42), 'sep');
      writeLog(`  ë¸”ë¡œê·¸ ë¶„ì„ ì‹œì‘: '${blogId}'`);
      writeLog('='.repeat(42), 'sep');
      writeLog(`[RSS] ì ‘ì† ì¤‘ â†’ rss.blog.naver.com/${blogId}.xml`);

      const posts = await fetchRSS(blogId);
      writeLog(`[RSS] ì´ ${posts.length}ê°œ í¬ìŠ¤íŒ… ë°œê²¬`);
      if (!posts.length) { writeLog('âŒ í¬ìŠ¤íŒ… ëª©ë¡ì„ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.', 'err'); hideLoading(); document.getElementById('analyzeBtn').disabled=false; return; }

      writeLog(''); writeLog('[ë¶„ì„] ë¸”ë¡œê·¸ë·° ë…¸ì¶œ ì—¬ë¶€ í™•ì¸ ì¤‘...'); writeLog('');

      let expCnt=0, missCnt=0;
      const table = document.createElement('table');
      table.innerHTML = `<thead><tr><th>#</th><th>í¬ìŠ¤íŒ… ì œëª©</th><th>ì‘ì„±ì¼</th><th>ë¸”ë¡œê·¸ë·° ë…¸ì¶œ</th></tr></thead>`;
      const tbody = document.createElement('tbody');
      table.appendChild(tbody);
      document.getElementById('resultArea').appendChild(table);
      document.getElementById('resultCount').textContent = posts.length;

      for (let i=0; i<posts.length; i++) {
        const post = posts[i];
        writeLog(`[${String(i+1).padStart(2,'0')}/${posts.length}] ${post.title.length>26?post.title.slice(0,26)+'â€¦':post.title}`);
        const items = await searchBlog(post.title.slice(0,30), clientId, clientSecret);
        let exposed = false;
        for (const it of items) { const l=it.link||''; if (l.toLowerCase().includes(blogId.toLowerCase())||(post.logNo&&l.includes(post.logNo))) { exposed=true; break; } }
        if (exposed) { expCnt++;  writeLog('  âœ… ë…¸ì¶œ í™•ì¸'); }
        else         { missCnt++; writeLog('  âŒ ëˆ„ë½', 'err'); }
        const tr = document.createElement('tr');
        tr.innerHTML = `<td class="tn">${i+1}</td><td class="tt"><a href="${post.url}" target="_blank" title="${post.title}">${post.title}</a></td><td class="td-date">${post.pubDate||'-'}</td><td><span class="badge ${exposed?'bok':'bmiss'}">${exposed?'âœ“ ë…¸ì¶œ':'âœ— ëˆ„ë½'}</span></td>`;
        tbody.appendChild(tr);
        document.getElementById('statTotal').textContent   = posts.length;
        document.getElementById('statExposed').textContent = expCnt;
        document.getElementById('statMissed').textContent  = missCnt;
        document.getElementById('statRate').textContent    = Math.round(expCnt/(i+1)*100)+'%';
        document.getElementById('statsArea').style.display = 'flex';
      }
      writeLog(''); writeLog('='.repeat(42),'sep');
      writeLog(`  ì™„ë£Œ!  ë…¸ì¶œ: ${expCnt}ê°œ  |  ëˆ„ë½: ${missCnt}ê°œ`);
      writeLog('='.repeat(42),'sep');
    } catch(e) { writeLog('ğŸš¨ ì˜¤ë¥˜: '+e.message,'err'); }
    hideLoading(); document.getElementById('analyzeBtn').disabled=false;
  }

  // â•â• íƒ­2: í‚¤ì›Œë“œ ìˆœìœ„ â•â•
  async function startKeywordCheck() {
    const blogId  = document.getElementById('kwBlogIdInput').value.trim();
    const rawText = document.getElementById('kwInput').value.trim();
    if (!blogId)  { alert('ë¸”ë¡œê·¸ ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
    if (!rawText) { alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
    const {clientId, clientSecret} = getConfig();
    if (!clientId||!clientSecret) { alert('ë¨¼ì € âš™ï¸ API ì„¤ì •ì„ ì™„ë£Œí•˜ì„¸ìš”.'); openApiModal(); return; }

    const keywords = rawText.split('\n').map(k=>k.trim()).filter(k=>k).slice(0,20);
    showLoading(`í‚¤ì›Œë“œ ${keywords.length}ê°œ ìˆœìœ„ í™•ì¸ ì¤‘...`, 'í‚¤ì›Œë“œ ìˆ˜ì— ë”°ë¼ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤');
    document.getElementById('kwBtn').disabled = true;
    document.getElementById('kwResults').innerHTML = '';

    for (let ki=0; ki<keywords.length; ki++) {
      const kw = keywords[ki];
      document.getElementById('ldText').textContent = `[${ki+1}/${keywords.length}] "${kw}" í™•ì¸ ì¤‘...`;

      try {
        const items = await searchBlog(kw, clientId, clientSecret);
        let myRank=0, myItem=null;
        for (let i=0; i<items.length; i++) {
          if ((items[i].link||'').toLowerCase().includes(blogId.toLowerCase())) { myRank=i+1; myItem=items[i]; break; }
        }

        const top5 = items.slice(0,5).map((it,idx) => {
          const isMine = (it.link||'').toLowerCase().includes(blogId.toLowerCase());
          const title  = (it.title||it.link||'').replace(/<[^>]+>/g,'');
          return `<div class="kw-item">
            <span class="kw-item-num">${idx+1}ìœ„</span>
            <div class="kw-item-info">
              <a href="${it.link}" target="_blank">${title}</a>
              ${it.bloggername ? `<div class="kw-item-blogger">@${it.bloggername}</div>` : ''}
            </div>
            ${isMine ? '<span class="kw-mine-tag">â­ ë‚´ ê¸€</span>' : ''}
          </div>`;
        }).join('');

        const card = document.createElement('div');
        card.className = 'kw-card';
        card.innerHTML = `
          <div class="kw-card-header">
            <div>
              <div class="kw-card-title">ğŸ”‘ ${kw}</div>
              <div class="kw-card-sub">ë„¤ì´ë²„ ë¸”ë¡œê·¸ ê²€ìƒ‰ ê¸°ì¤€ Â· ìƒìœ„ 100ìœ„</div>
            </div>
            <div class="kw-rank ${myRank>0?'found':'not-found'}">${myRank>0?myRank+'ìœ„':'100ìœ„ ë°–'}</div>
          </div>
          <div class="kw-card-body">
            <div class="kw-my-result ${myRank>0?'found':'not-found'}">
              <div class="kw-my-label ${myRank>0?'found':'not-found'}">${myRank>0?`âœ… ë‚´ ë¸”ë¡œê·¸ ${myRank}ìœ„ì— ë…¸ì¶œ ì¤‘`:'âŒ ì´ í‚¤ì›Œë“œì—ì„œ ë‚´ ë¸”ë¡œê·¸ê°€ 100ìœ„ ì•ˆì— ì—†ìŠµë‹ˆë‹¤'}</div>
              ${myRank>0&&myItem?`<div class="kw-my-post-title"><a href="${myItem.link}" target="_blank">${(myItem.title||myItem.link).replace(/<[^>]+>/g,'')}</a></div>`:''}
            </div>
            <div class="kw-top-label">ìƒìœ„ 5ê°œ ê²€ìƒ‰ ê²°ê³¼</div>
            ${top5}
          </div>`;
        document.getElementById('kwResults').appendChild(card);
      } catch(e) {
        const card = document.createElement('div');
        card.className = 'kw-card';
        card.innerHTML = `<div class="kw-card-header"><div class="kw-card-title">ğŸ”‘ ${kw}</div><div style="color:var(--red);font-size:12px">ì˜¤ë¥˜ ë°œìƒ</div></div>`;
        document.getElementById('kwResults').appendChild(card);
      }
    }
    hideLoading(); document.getElementById('kwBtn').disabled=false;
  }
</script>
</body>
</html>
